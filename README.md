<details><summary>目录</summary><p>

- [动手学习强化学习](#动手学习强化学习)
    - [初探强化学习](#初探强化学习)
        - [什么是强化学习](#什么是强化学习)
        - [强化学习的环境](#强化学习的环境)
        - [强化学习的目标](#强化学习的目标)
        - [强化学习中的数据](#强化学习中的数据)
        - [强化学习的独特性](#强化学习的独特性)
        - [小结](#小结)
</p></details><p></p>


# 动手学习强化学习

## 初探强化学习

* 序贯决策(sequential decision marking)
* 强化学习(reinforcement learning)

### 什么是强化学习

广泛地讲，强化学习是机器通过与环境交互来实现目标的一种计算方法。机器和环境的一轮交互是指，
机器在环境的一个状态下做一个动作决策，把这个动作作用到环境当中，
这个环境发生相应的改变并且将相应的奖励反馈和下一轮状态传回机器。这种交互是迭代进行的，
机器的目标是最大化在多轮交互过程中获得的累积奖励的期望。
强化学习用智能体（agent）这个概念来表示做决策的机器。相比于有监督学习中的“模型”，
强化学习中的“智能体”强调机器不但可以感知周围的环境信息，还可以通过做决策来直接改变这个环境，
而不只是给出一些预测信号。

这里，智能体有3种关键要素，即感知、决策和奖励。

* 感知。智能体在某种程度上感知环境的状态，从而知道自己所处的现状。
  例如，下围棋的智能体感知当前的棋盘情况；无人车感知周围道路的车辆、行人和红绿灯等情况；
  机器狗通过摄像头感知面前的图像，通过脚底的力学传感器来感知地面的摩擦功率和倾斜度等情况。
* 智能体根据当前的状态计算出达到目标需要采取的动作的过程叫作决策。例如，针对当前的棋盘决定下一颗落子的位置；
  针对当前的路况，无人车计算出方向盘的角度和刹车、油门的力度；针对当前收集到的视觉和力觉信号，
  机器狗给出4条腿的齿轮的角速度。策略是智能体最终体现出的智能形式，是不同智能体之间的核心区别。
* 奖励。环境根据状态和智能体采取的动作，产生一个标量信号作为奖励反馈。这个标量信号衡量智能体这一轮动作的好坏。
  例如，围棋博弈是否胜利；无人车是否安全、平稳且快速地行驶；机器狗是否在前进而没有摔倒。
  最大化累积奖励期望是智能体提升策略的目标，也是衡量智能体策略好坏的关键指标。

从以上分析可以看出，面向决策任务的强化学习和面向预测任务的有监督学习在形式上是有不少区别的。

* 首先，决策任务往往涉及多轮交互，即序贯决策；而预测任务总是单轮的独立任务。
  如果决策也是单轮的，那么它可以转化为“判别最优动作”的预测任务。
* 其次，因为决策任务是多轮的，智能体就需要在每轮做决策时考虑未来环境相应的改变，
  所以当前轮带来最大奖励反馈的动作，在长期来看并不一定是最优的。

### 强化学习的环境

强化学习的智能体是在和一个动态环境的交互中完成序贯决策的。我们说一个环境是动态的，
意思就是它会随着某些因素的变化而不断演变，这在数学和物理中往往用随机过程来刻画。
对于一个随机过程，其最关键的要素就是状态以及状态转移的条件概率分布。

如果在环境这样一个自身演变的随机过程中加入一个外来的干扰因素，即智能体的动作，
那么环境的下一刻状态的概率分布将由当前状态和智能体的动作来共同决定，用最简单的数学公式表示则是

$$\text{下一状态}\sim P(\cdot|\text{当前状态}, \text{智能体的动作})$$

根据上式可知，智能体决策的动作作用到环境中，使得环境发生相应的状态改变，
而智能体接下来则需要在新的状态下进一步给出决策。

由此我们看到，与面向决策任务的智能体进行交互的环境是一个动态的随机过程，
其未来状态的分布由当前状态和智能体决策的动作来共同决定，并且每一轮状态转移都伴随着两方面的随机性：
一是智能体决策的动作的随机性，二是环境基于当前状态和智能体动作来采样下一刻状态的随机性。
通过对环境的动态随机过程的刻画，我们能清楚地感受到，在动态随机过程中学习和在一个固定的数据分布下学习是非常不同的。

### 强化学习的目标

智能体和环境每次进行交互时，环境会产生相应的奖励信号，其往往由实数标量来表示。
这个奖励信号一般是诠释当前状态或动作的好坏的及时反馈信号，好比在玩游戏的过程中某一个操作获得的分数值。
整个交互过程的每一轮获得的奖励信号可以进行累加，形成智能体的整体 **回报（return）**，
好比一盘游戏最后的分数值。根据环境的动态性我们可以知道，即使环境和智能体策略不变，
智能体的初始状态也不变，智能体和环境交互产生的结果也很可能是不同的，对应获得的回报也会不同。
因此，在强化学习中，我们关注回报的期望，并将其定义为 **价值（value）**，这就是强化学习中智能体学习的优化目标。

### 强化学习中的数据

有监督学习的任务建立在从给定的数据分布中采样得到的训练数据集上，
通过优化在训练数据集中设定的目标函数（如最小化预测误差）来找到模型的最优参数。
这里，训练数据集背后的数据分布是完全不变的。

在强化学习中，数据是在智能体与环境交互的过程中得到的。如果智能体不采取某个决策动作，
那么该动作对应的数据就永远无法被观测到，所以当前智能体的训练数据来自之前智能体的决策结果。
因此，智能体的策略不同，与环境交互所产生的数据分布就不同

### 强化学习的独特性

一般的有监督学习任务：目标是找到一个最优的模型函数，使其在训练数据集上最小化一个给定的损失函数。
在训练数据独立同分布的假设下，这个优化目标表示最小化模型在整个数据分布上的泛化误差(generalization error)

$$\text{最优模型} = arg \underset{模型}{max} \mathbb{E}_{(\text{特征, 标签})\sim \text{数据分布}}[损失函数(标签, 模型(特征))]$$

强化学习任务：最终优化目标是最大化智能体策略在和动态环境交互过程中的价值。
策略的价值可以等价转换成奖励函数在策略的占用度量上的期望

$$\text{最优策略}= arg\underset{模型}{max}\mathbb{E}_{(\text{状态,动作})\sim\text{策略的占用度量}}[\text{奖励函数(状态, 动作)}]$$

观察以上两个优化公式，总结出两者的相似点和不同点。

* 有监督学习和强化学习的优化目标相似，即都是在优化某个数据分布下的一个分数值的期望。
* 二者优化的途径是不同的，有监督学习直接通过优化模型对于数据特征的输出来优化目标，
  即修改目标函数而数据分布不变；强化学习则通过改变策略来调整智能体和环境交互数据的分布，
  进而优化目标，即修改数据分布而目标函数不变。

综上所述，一般有监督学习和强化学习的范式之间的区别为：

* 一般的有监督学习关注寻找一个模型，使其在给定数据分布下得到的损失函数的期望最小；
* 强化学习关注寻找一个智能体策略，使其在与动态环境交互的过程中产生最优的数据分布，
  即最大化该分布下一个给定奖励函数的期望。

### 小结

在大多数情况下，强化学习任务往往比一般的有监督学习任务更难，因为一旦策略有所改变，
其交互产生的数据分布也会随之改变，并且这样的改变是高度复杂、不可追踪的，往往不能用显式的数学公式刻画。
这就好像一个混沌系统，我们无法得到其中一个初始设置对应的最终状态分布，而一般的有监督学习任务并没有这样的混沌效应。



